/*!
 * This file is part of MeCms.
 * @author		Mirko Pagliai <mirko.pagliai@gmail.com>
 * @copyright	Copyright (c) 2015, Mirko Pagliai for Nova Atlantis Ltd
 * @license		http://www.gnu.org/licenses/agpl.txt AGPL License
 */
$(function(){function t(t){for(var e=0;e<v.length;e++)if(v[e].value===t)return!0;return!1}function e(e){$.each(e,function(e,a){if(!(a.length<=3||t(a))){a=a.toLowerCase();for(var n="àáäâèéëêìíïîòóöôùúüûñç",o="aaaaeeeeiiiioooouuuunc",i=0,u=n.length;u>i;i++)a=a.replace(new RegExp(n.charAt(i),"g"),o.charAt(i));a=a.replace(/[^a-z0-9]/g,""),v.push({key:c,value:a});var l='<button type="button" data-tag="'+c+'" class="tag-remove" href="#">&times;</button>';r.append('<div data-tag="'+c+'">'+a+l+"</div>"),c++}}),n()}function a(t){for(var e=0;e<v.length;e++)if(v[e].key===parseInt(t)){v.splice(e,1),$("div[data-tag="+t+"]",r).remove();break}n()}function n(){var t=[];$.each(v,function(e,a){t.push(a.value)}),u.val(t.join(" "))}var o=$("#tags-input-button"),i=$("#tags-input-text"),u=$("#tags-output-text"),r=$("#tags-preview"),c=1,v=[];e(u.val().split(/[\s]+/)),o.click(function(){var t=i.val().replace(/^\s+|\s+$/g,"");return t.length?(i.val(""),void e(t.split(/[\s]+/))):!1}),$(r).on("click",".tag-remove",function(){a($(this).attr("data-tag"))}),$(i).on("focusin",function(){$(this).off("keydown").keydown(function(t){return 13==t.keyCode?(t.preventDefault(),o.click(),!1):void 0})})});